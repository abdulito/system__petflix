$parameters:
  mongodb_uri:
    type: secret
  node_pool:
    type: string
  version:
    type: string

type: v1/job

build:
  type: command_build

  source:
    git_repository:
      url: https://github.com/mlab-lattice/example-petflix-service.git
      version: 2.x
  base_image:
    repository: library/mongo
    tag: ${version}

  command:
    - "true"

exec:
  environment:
    MONGO_URI: ${mongodb_uri}
  command:
  - /bin/bash
  - -c
  - mongoimport
  - --uri=$MONGO_URI
  - --collection=petflix
  - --jsonArray
  - --file=seed-data.json

node_pool: ${node_pool}
